<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"></link>
    <style>
        #__history {
            color: silver !important;
            position: absolute;
            left: 2%;
            width: 47%;
            max-height: 100%;
            overflow: scroll;
        }

        #__history .__inlineMacro {
            animation: none;
            color: silver;
        }

        #__currentSection {
            color: black;
            animation: 2s textFadeIn;
            position: absolute;
            left: 51%;
            width: 47%;
            max-height: 100%;
            overflow: scroll;
        }

        .__disabledLink {
            color: silver;
            text-decoration: underline;
        }

        .__inlineMacro {
            animation: 2s inlineMacroFadeIn;
            color: blue;
        }

        @keyframes textFadeIn {
            from {
                color: white;
            }
            to {
                color: black;
            }
        }

        @keyframes inlineMacroFadeIn {
            from {
                color: white;
            }
            to {
                color: blue;
            }
        }
    </style>
    <script>
        var exports = {};
        "use strict";
        Object.defineProperty(exports, "__esModule", {
            value: true
        });
        var Core;
        (function(Core) {
            function EnableInlineMacros(root, tf) {
                if (tf === void 0) {
                    tf = true;
                }
                if (tf && root.id.search("_inline\-") > -1) {
                    root.id = root.id.substring(1);
                } else if (!tf && root.id.search("inline\-") > -1) {
                    root.id = "_" + root.id;
                }
                for (var i = 0; i < root.children.length; i++) {
                    EnableInlineMacros(root.children[i], tf);
                }
            }

            function ExpandMacro(macro) {
                switch (macro[0]) {
                    case '@':
                        {
                            var sectionName = macro.substring(1);
                            if (!document.getElementById(sectionName)) {
                                return "{section \"" + sectionName + "\" is not declared}";
                            } else {
                                return ExpandSection(macro.substring(1)).innerHTML;
                            }
                        }
                    case '#':
                        {
                            var targetObject = null;
                            var tokens = macro.substring(1).split('.');
                            for (var i = 0; i < tokens.length; i++) {
                                if (i === 0) {
                                    targetObject = window[tokens[0]];
                                } else {
                                    targetObject = targetObject[tokens[i]];
                                }
                            }
                            if (targetObject === undefined) {
                                return "{function \"" + macro.substring(1) + "\" is not declared}";
                            } else {
                                return targetObject().toString();
                            }
                        }
                    case '$':
                        {
                            var targetObject = null;
                            var tokens = macro.substring(1).split('.');
                            for (var i = 0; i < tokens.length; i++) {
                                if (i === 0) {
                                    targetObject = window[tokens[0]];
                                } else {
                                    targetObject = targetObject[tokens[i]];
                                }
                            }
                            if (targetObject === undefined) {
                                return "{variable \"" + macro.substring(1) + "\" is not declared}";
                            } else {
                                return targetObject.toString();
                            }
                        }
                    default:
                        {
                            return "{unknown metacharacter in macro \"" + macro + "\"";
                        }
                }
            }
            Core.ExpandMacro = ExpandMacro;

            function ExpandSection(id) {
                var source = document.getElementById(id);
                if (source === null) {
                    console.log("Section " + id + " doesn't exist");
                    return null;
                }
                var sectionInstance = source.cloneNode(true);
                sectionInstance.removeAttribute("hidden");
                var scan = function(element) {
                    for (var i = 0; i < element.attributes.length; i++) {
                        var expanded = false;
                        switch (element.attributes[i].name) {
                            case "data-expand-macro":
                                {
                                    if (element.parentElement) {
                                        var newElement = document.createElement("span");
                                        newElement.innerHTML = ExpandMacro(element.attributes[i].value);
                                        element.parentElement.replaceChild(newElement, element);
                                        expanded = true;
                                    }
                                    break;
                                }
                            case "data-image-source-macro":
                                {
                                    var source_1 = ExpandMacro(element.attributes[i].value);
                                    console.log("Expanding " + element.tagName + " with src attribute " + element.attributes[i].value + " to \"" + source_1 + "\"");
                                    element.setAttribute("src", ExpandMacro(element.attributes[i].value));
                                    expanded = true;
                                }
                        }
                        if (expanded) {
                            break;
                        }
                    }
                    if (element.hasChildNodes) {
                        for (var i = 0; i < element.children.length; i++) {
                            scan(element.children[i]);
                        }
                    }
                };
                scan(sectionInstance);
                return sectionInstance;
            }

            function GotoSection(id) {
                var history = document.getElementById("__history");
                var currentSection = document.getElementById("__currentSection");
                var links = currentSection.getElementsByTagName("a");
                for (var i = 0; i < links.length;) {
                    var contents = links[i].outerHTML.substring(links[i].outerHTML.indexOf(">") + 1, links[i].outerHTML.indexOf("</a>"));
                    links[i].outerHTML = "<span class=\"__disabledLink\">" + contents + "</span>";
                }
                history.innerHTML += currentSection.innerHTML;
                history.scrollTop = history.scrollHeight;
                var clone = ExpandSection(id);
                EnableInlineMacros(clone, true);
                RegisterLinks(clone);
                clone.scrollTop = 0;
                clone.id = "__currentSection";
                currentSection.parentElement.replaceChild(clone, currentSection);
            }
            Core.GotoSection = GotoSection;

            function RegisterLinks(element) {
                if (element.tagName == "A") {
                    var _loop_1 = function(i) {
                        switch (element.attributes[i].name) {
                            case "data-goto-section":
                                {
                                    element.addEventListener("click", function() {
                                        Core.GotoSection(element.attributes[i].value);
                                    });
                                    break;
                                }
                            case "data-call-function":
                                {
                                    element.addEventListener("click", window[element.attributes[i].value]);
                                    break;
                                }
                            case "data-replace-with":
                                {
                                    element.addEventListener("click", function() {
                                        Core.ReplaceActiveElement(element.id, ExpandMacro(element.attributes[i].value));
                                    });
                                    break;
                                }
                        }
                    };
                    for (var i = 0; i < element.attributes.length; i++) {
                        _loop_1(i);
                    }
                }
                if (element.hasChildNodes) {
                    for (var i = 0; i < element.children.length; i++) {
                        RegisterLinks(element.children[i]);
                    }
                }
            }
            Core.RegisterLinks = RegisterLinks;

            function ReplaceActiveElement(id, html) {
                for (var element = document.getElementById(id); element; element = document.getElementById(id)) {
                    if (!element) {
                        continue;
                    }
                    var bIsActive = false;
                    for (var parent_1 = element.parentElement; parent_1; parent_1 = parent_1.parentElement) {
                        if (parent_1.id === "__currentSection") {
                            bIsActive = true;
                            break;
                        }
                    }
                    if (bIsActive) {
                        var replacement = document.createElement("span");
                        replacement.className = "__inlineMacro";
                        replacement.innerHTML = html;
                        EnableInlineMacros(replacement, true);
                        RegisterLinks(replacement);
                        element.parentNode.replaceChild(replacement, element);
                        break;
                    }
                }
            }
            Core.ReplaceActiveElement = ReplaceActiveElement;

            function ShowHistory(tf) {
                var history = document.getElementById("__history");
                history.hidden = !tf;
            }
            Core.ShowHistory = ShowHistory;
        })(Core = exports.Core || (exports.Core = {}));
        //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29yZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9Db3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBc0JBLElBQWlCLElBQUksQ0F1UnBCO0FBdlJELFdBQWlCLElBQUk7SUFTcEIsNEJBQTRCLElBQWMsRUFBRSxFQUFtQjtRQUFuQixtQkFBQSxFQUFBLFNBQW1CO1FBSTlELEVBQUUsQ0FBQSxDQUFDLEVBQUUsSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFBQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQUMsQ0FBQztRQUM5RSxJQUFJLENBQUMsRUFBRSxDQUFBLENBQUMsQ0FBQyxFQUFFLElBQUksSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxNQUFJLElBQUksQ0FBQyxFQUFJLENBQUM7UUFBQyxDQUFDO1FBRzVFLEdBQUcsQ0FBQSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQzVDLENBQUM7WUFDQSxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzFDLENBQUM7SUFDRixDQUFDO0lBVUQscUJBQTRCLEtBQWM7UUFFekMsTUFBTSxDQUFBLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQ2hCLENBQUM7WUFDQSxLQUFLLEdBQUc7Z0JBQ1IsQ0FBQztvQkFDQSxJQUFJLFdBQVcsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFD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// source/script.js
        function HideHistory() {
            Core.ShowHistory(false);
        }

        function FunctionLink() {
            alert("It might look like this, if your function was programmed to raise a browser alert (as this one was). Other functions could do complex logic to choose different sections to go to based on things like player state (do you have a certain item in your inventory?) or even a random roll of the dice!");
        }

        function VariableLink() {
            alert("You'll actually get a compiler error, because it doesn't make sense to link to a variable. In this case, I've linked to a function instead; specifically, one that shows you this alert.");
        }

        function InlineFunction() {
            return "This paragraph is some inline text that comes from a function call! In this case, I put a \
function macro in my story text, then had the function return the text I wanted to display. In a real \
game, you could have the function do some kind of game logic that decides what to display; for instance, \
you could have it check if the player has a particular inventory item, and say one thing if they do \
and something different if they don't.";
        }

        var InlineVariable = "\"Hello, world!\"";

        function RaiseAlert() {
            alert("fractive is super cool!");
        }

        function InlineExpansionFunction() {
            return "function (functions should return the string that will replace the link)";
        }

        var InlineExpansionVariable = "variable (a string which will replace the link)";
    </script>
</head>

<body>
    <!-- source/text.md -->
    <div id="Start" class="section" hidden="true">
        <h1>Welcome!</h1>
        <p>Welcome to fractive, a tool for creating hypertext fiction!</p>
        <p>Fractive stories are written in Markdown, and you can add (optional) game logic in Javascript. Stories consist of &quot;sections&quot;, which you might think of like one page of a book. Typically a section will give you a bit of narrative and
            then present one or more choices to the player; each choice takes the story to a different section, and in a different direction.</p>
        <p>In Markdown, you declare the beginning of a new section by enclosing the section name (which must be unique!) in double curly braces. The section you're reading right now is called <code>{{Start}}</code> which is a special section name that indicates
            where the story begins.</p>
        <p><a title="{@AnotherSection}" href="#" data-goto-section="AnotherSection">Link to another section</a></p>
    </div>
    <div id="AnotherSection" class="section" hidden="true">
        <p>You just clicked a link that took you to another section! You create section links just like any ol' Markdown link, but in place of the URL you put a special <em>macro</em> enclosed in single curly braces. There are three types of macros, each
            denoted by a symbol:</p>
        <ul>
            <li>@ denotes a section name to link to</li>
            <li># denotes a Javascript function to call</li>
            <li>$ denotes a Javascript variable</li>
        </ul>
        <p>So if you set the URL to <code>{@Start}</code> you'd have created a link back to the section called <code>Start</code>. If on the other hand you'd put <code>{#Start}</code> you'd have created a link that would call a Javascript function called
            <code>Start</code>.</p>
        <p><a title="{#FunctionLink}" href="#" data-call-function="FunctionLink">What does it look like when a link calls a Javascript function?</a><br/><a title="{#VariableLink}" href="#" data-call-function="VariableLink">What happens if I set the link URL to a variable macro?</a><br/>
            <a
                title="{@InlineMacros}" href="#" data-goto-section="InlineMacros">What else can I use macros for?</a>
        </p>
        <p>(P.S. Notice that the first section is still displayed above. That's because we keep track of your play history in a scrollback. You can <a title="{#HideHistory}" href="#" data-call-function="HideHistory">hide the history</a> if you like. The
            UX for this is still going to need some work.)</p>
    </div>
    <div id="InlineMacros" class="section" hidden="true">
        <p>Macros aren't only for links; you can also use them to add dynamic text to your sections.</p>
        <blockquote>
            <p><span data-expand-macro="#InlineFunction"></span></p>
        </blockquote>
        <p>The above paragraph was the result of inlining a function call, which expects the function to return a string. You can also inline the value of a variable. Here's one: <span data-expand-macro="$InlineVariable"></span></p>
        <p>You can even inline an entire section:</p>
        <blockquote>
            <p><span data-expand-macro="@InlineSection"></span></p>
        </blockquote>
        <p>The inlined function and section above are indented, but that's only because I prefaced them with the Markdown blockquote indicator for clarity. Inlines don't inherently get any special styling, so you can inline things totally seamlessly and
            your players will never know the difference.</p>
        <p>Finally, you can create links which expand to text in-place, which is commonly used in e.g. <a title="https://twinery.org/2/" target="_blank" href="https://twinery.org/2/">Twine&nbsp;<i class="fa fa-external-link" aria-hidden="true"></i></a> games
            for artistic effect. You can link to a <a title="{$InlineExpansionVariable:inline}" href="#" data-replace-with="$InlineExpansionVariable" id="_inline-0">variable</a>, or to the return value of a <a title="{#InlineExpansionFunction:inline}"
                href="#" data-replace-with="#InlineExpansionFunction" id="_inline-1">function</a>, and they'll expand in-place.</p>
        <p><a title="{@InlineExpansionSection:inline}" href="#" data-replace-with="@InlineExpansionSection" id="_inline-2">You can also do this with a section</a></p>
        <p><a title="{@AboutFormatting}" href="#" data-goto-section="AboutFormatting">Can I use Markdown styling?</a></p>
    </div>
    <div id="InlineSection" class="section" hidden="true">
        <p>This paragraph was written in an entirely different section, but it appears as part of the section you're already reading. This might be useful if you have some boilerplate text that needs to follow the player around from place to place; you could
            put it in a section and inline it, instead of copy-pasting the same sentences (or paragraphs) all over your story text.</p>
    </div>
    <div id="InlineExpansionSection" class="section" hidden="true">
        <p>Sections are kind of special though, in that they don't actually appear inline <em>per se</em>, because they're block-level elements (i.e. their own paragraphs) which means they'll put a paragraph break where they appear. They still replace their
            :inline macro link though, just like with variables and functions. When inline-expanding a section, you can still have paragraph breaks, <em>additional</em> <strong>formatting</strong>, and so on. And you can even inline sections which themselves
            contain <a title="{#RaiseAlert}" href="#" data-call-function="RaiseAlert">macros</a>!</p>
    </div>
    <div id="AboutFormatting" class="section" hidden="true">
        <p>Story text is written in Markdown, which means we have access to <em>all kinds</em> of <strong>formatting</strong>, including:</p>
        <h1>Headers</h1>
        <h2>Sub-headers</h2>
        <ul>
            <li>Unordered lists (like this one)</li>
            <li>Ordered lists (1, 2, 3, 4...)</li>
            <li>Links can also <a title="{#RaiseAlert}" href="#" data-call-function="RaiseAlert"><em>contain</em> <strong>formatting</strong></a></li>
        </ul>
        <p>Basically, anything Markdown can do, you can do in your story text! You can even inline <span style="color:#ff0000">raw HTML</span> which means you could do video embeds, HTML5 canvas, and all kinds of other fancy stuff.</p>
        <p>And of course, because fractive games are ultimately HTML in the end, you can create your own HTML template with whatever layout you want, and style it with CSS. For example, you could surround your game with a header and footer, or create a sidebar
            which (along with some custom Javascript) tracks your player's inventory and stats as they move through the story.</p>
        <p><a title="{@LongStories}" href="#" data-goto-section="LongStories">How does fractive handle long/complicated stories?</a></p>
    </div>
    <div id="LongStories" class="section" hidden="true">
        <p>Fractive's main goal is to be the best tool for writing complex, dynamic hypertext fiction that has lots of branches and genuinely consequential choices. What you're reading right now is produced by a <em>very</em> eary version of the tool, so
            this goal isn't fully realized yet, but it is the direction I'm heading.</p>
        <p>You can split long story text up into as many individual Markdown files as you like, and they can be named whatever you like. The same goes for game logic in Javascript; you could have separate .js files for each logical class, or for each scene
            or major location in your story, or however else you'd like to organize it. When you publish your story, all the files in the story source folder are gathered up automatically, and everything gets compiled together into a single self-contained
            HTML file.</p>
        <p>In the future I'll be exploring additional tools and visualizations to help authors understand, trace, and debug the complexity of large, deeply-branching narratives. Those tools and visualizers will likely be the most experimental, and pivotal,
            aspects of fractive's development.</p>
        <p>Anything you'd like to review?</p>
        <p><a title="{#FunctionLink}" href="#" data-call-function="FunctionLink">What does it look like when a link calls a Javascript function?</a><br/><a title="{#VariableLink}" href="#" data-call-function="VariableLink">What happens if I set the link URL to a variable macro?</a><br/>
            <a
                title="{@InlineMacros}" href="#" data-goto-section="InlineMacros">What else can I use macros for?</a><br/><a title="{@AboutFormatting}" href="#" data-goto-section="AboutFormatting">Can I use Markdown styling?</a></p>
    </div>

    <div id="__history"></div>
    <div id="__currentSection"></div>
</body>

</html>
<script>
    Core.GotoSection("Start");
</script>